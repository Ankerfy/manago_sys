顶部加载进度条（类似 YouTube、Nuxt、Vue Router 的加载体验）可以极大提升用户对页面加载的感知体验。

实现方案：使用 **NProgress** 库 + **pnpm 安装** + **在 Vue 3 项目中集成**，并结合路由实现自动进度条。

---

### ✅ 一、什么是 NProgress？

`NProgress` 是一个轻量级的顶部进度条库，特点：

- 简洁美观
- 自动控制进度（可手动调用）
- 支持 `start()`、`done()`、`set()` 等方法
- 与 Vue Router 完美配合

官网：[https://github.com/rstacruz/nprogress](https://github.com/rstacruz/nprogress)

---

### ✅ 二、使用 pnpm 安装 NProgress

```bash
pnpm add nprogress
```

> ✅ 会自动安装到 `package.json` 的 `dependencies` 中

同时建议安装对应的 **CSS 样式文件**（已包含在库中）。

---

### ✅ 三、引入 NProgress 并配置样式（可选定制）

#### 1. 在 `main.js` 或 `main.ts` 中引入

```js
// src/main.js
import { createApp } from 'vue'
import App from './App.vue'
import router from './router'

// 引入 NProgress JS 和 CSS
import NProgress from 'nprogress'
import 'nprogress/nprogress.css'

// 可选：自定义样式（覆盖默认主题）
import './assets/css/nprogress-custom.css'

const app = createApp(App)

// 全局挂载（可选，不推荐）
// app.config.globalProperties.$nprogress = NProgress

app.use(router).mount('#app')
```

---

#### 2. （可选）自定义样式文件 `src/assets/css/nprogress-custom.css`

```css
/* src/assets/css/nprogress-custom.css */
#nprogress {
  pointer-events: none;
}

#nprogress .bar {
  background: #409eff; /* Element Plus 主色 */
  height: 3px !important;
  box-shadow: 0 0 4px rgba(64, 158, 255, 0.8);
}

#nprogress .peg {
  box-shadow:
    0 0 10px #409eff,
    0 0 5px #409eff;
}

#nprogress .spinner {
  display: none; /* 隐藏右上角小圆圈（可选） */
}
```

---

### ✅ 四、结合 Vue Router 实现自动进度条

#### 修改 `router/index.js`，在路由守卫中调用 NProgress

```js
// src/router/index.js
import { createRouter, createWebHistory } from 'vue-router'
import NProgress from 'nprogress'

const router = createRouter({
  history: createWebHistory(import.meta.env.BASE_URL),
  routes: [
    /* 你的路由 */
  ],
})

// 全局前置守卫：路由跳转开始 → 启动进度条
router.beforeEach((to, from) => {
  NProgress.start()
})

// 全局后置钩子：路由跳转完成 → 结束进度条
router.afterEach((to, from) => {
  NProgress.done()
})

// 可选：错误处理
router.onError((error) => {
  console.error('路由错误:', error)
  NProgress.done() // 防止卡住
})

export default router
```

---

### ✅ 五、效果说明

| 场景             | 行为                                       |
| ---------------- | ------------------------------------------ |
| 点击菜单跳转路由 | 进度条从 0% 开始动画，逐步推进，完成时消失 |
| 刷新页面         | 页面加载时进度条自动出现并完成             |
| 加载慢的页面     | 进度条持续动画，避免用户以为“卡住”         |
| 路由报错         | `onError` 中调用 `done()` 防止进度条卡住   |

---

### ✅ 六、手动控制进度条（高级用法）

你也可以在组件中手动控制进度条，比如：

```vue
<script setup>
import NProgress from 'nprogress'

// 模拟异步操作
const loadData = async () => {
  NProgress.start()

  try {
    await fetch('/api/data') // 模拟请求
    await new Promise((resolve) => setTimeout(resolve, 800))
  } catch (err) {
    NProgress.done()
    return
  }

  NProgress.done() // 完成
}
</script>

<template>
  <el-button @click="loadData">手动加载数据</el-button>
</template>
```

---

### ✅ 七、NProgress 常用 API

| 方法                                                  | 说明                              |
| ----------------------------------------------------- | --------------------------------- |
| `NProgress.start()`                                   | 开始进度条（自动从 0% 到 90%）    |
| `NProgress.done()`                                    | 完成进度条（跳到 100%，然后隐藏） |
| `NProgress.set(0.5)`                                  | 设置进度为 50%                    |
| `NProgress.inc()`                                     | 增加一个随机进度（适合未知时长）  |
| `NProgress.configure({ easing, speed, showSpinner })` | 配置参数                          |

示例配置：

```js
// src/main.js 或 router/index.js
NProgress.configure({
  easing: 'ease', // 动画方式
  speed: 500, // 速度（ms）
  showSpinner: false, // 是否显示右上角旋转图标
})
```

---

### ✅ 八、最终效果预览

当你刷新页面或切换路由时，浏览器顶部会出现一条蓝色进度条：

```
[████████████████████████████████████░░░░] 90%
```

- 平滑动画推进
- 自动完成
- 样式可定制（颜色、高度、阴影等）

---

### ✅ 总结

| 步骤                  | 命令 / 代码                                                                  |
| --------------------- | ---------------------------------------------------------------------------- |
| 1. 安装 NProgress     | `pnpm add nprogress`                                                         |
| 2. 引入 JS 和 CSS     | `import NProgress from 'nprogress'` + `import 'nprogress/nprogress.css'`     |
| 3. 在路由守卫中使用   | `beforeEach(() => NProgress.start())`<br>`afterEach(() => NProgress.done())` |
| 4. （可选）自定义样式 | 添加 CSS 覆盖 `.bar`、`.spinner` 等                                          |

---

✅ **推荐指数：⭐⭐⭐⭐⭐**

NProgress 是 Vue 项目中实现顶部加载进度条的 **最佳选择之一**，轻量、稳定、易用，完美适配 Element Plus 风格。

如果你希望使用更现代的替代品（如 `@tanstack/router` 风格），也可以考虑 `turbolinks` 或 `instant.page`，但对于大多数 Vue 项目，**NProgress + Vue Router** 是最简单高效的方案。

需要我帮你封装一个 `useProgress()` Hook 或全局指令吗？欢迎继续提问！
